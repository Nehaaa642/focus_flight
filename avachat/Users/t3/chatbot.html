<!DOCTYPE html>
<html>

<head>
    <title>Chatbot</title>
    <link rel="stylesheet" href="../../style.css">
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }

        .chat-popup {
            display: none;
            position: fixed;
            bottom: 15px;
            right: 15px;
            border: 1px solid #ccc;
            width: 300px;
            max-height: 400px;
            overflow: auto;
        }

        .chat-popup-header {
            background-color: skyblue;
            color: white;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            user-select: none;
        }

        .chat-popup-content {
            padding: 10px;
        }

        .user-input {
            display: 1flex;
            margin-top: 10px;
        }

        .user-input input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .user-input button {
            padding: 3px;
            margin-left: 0px;
            background-color: skyblue;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Added style for the chat header text */
        .chat-header-text {
            cursor: pointer;
            font-size: 14px;
            text-align: center;
            background-color: #4CAF50;
            color: white;
            padding: 5px;
            border-radius: 5px;
            position: fixed;
            bottom: 0;
            right: 15px;
        }
    </style>
</head>

<body>
    <div class="chat-popup" id="chat-popup">
        <div class="chat-popup-header" onclick="toggleChat()">Chatbot</div>
        <div class="chat-popup-content" id="chat-window">
            <!-- The chat window where messages will be displayed -->
        </div>
        <div class="user-input">
            <input type="text" id="user-input" placeholder="Type your question...">
            <button onclick="sendUserInput()">Send</button>
        </div>
    </div>

    <!-- Added chat header text for toggling the chat window -->
    <div class="chat-header-text" onclick="toggleChat()">Chat</div>

    <script src="../../script.js"></script>
    <script>
        function toggleChat() {
            var chatPopup = document.getElementById('chat-popup');
            chatPopup.style.display = (chatPopup.style.display === 'block') ? 'none' : 'block';
        }

        function sendUserInput() {
            const userInputField = document.getElementById('user-input');
            var userInput = document.getElementById('user-input').value;
            var chatWindow = document.getElementById('chat-window');

            var user_name = 't3';

            displayMessage("User: " + userInput);

            // Make an AJAX request to the server (PHP)
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "http://localhost/Test%20Bot/chatbot_request.php", true);
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    var response = xhr.responseText;
                    displayMessage("Bot: " + response);
                }
            };


            // Send user input to the server
            xhr.send("userInput=" + encodeURIComponent(userInput) + "&user_name=" + encodeURIComponent(user_name));
            userInputField.value = '';
        }

        function displayMessage(message) {
            var chatWindow = document.getElementById('chat-window');
            var newMessage = document.createElement('div');
            newMessage.textContent = message;
            chatWindow.appendChild(newMessage);
        }
    </script>
</body>

</html>
